library(readxl)
library(tidyverse)



##############################################################
#######     complement table vulnerability traits 

#introducir listado gral spp BP
listSpp <- read_excel("listSpp.xlsx", sheet = "Sheet2")        
listSpp
#cargar datos con rasgos
traits<-  read.csv('RasgosCL_longformat.csv', header = TRUE)


#expand traits in a wider form

trait.wide<- traits %>% 
  select(accepted_species, traitName, traitValue) %>% 
    spread(traitName, traitValue)
   
#pivot_wider(names_from = traitName, values_from = traitValue) %>% 
group_by(accepted_species) %>% 
  select(Dispersal_syndrome_1, 
         Fruit_type_1,
         Mycorrhizal_type_1,
         Pollination_syndrome_1,
         Seed_mass,
         traitUnit,
         originalValue) %>% 
 na.omit()
trait.wide

write.csv(trait.wide, "trait.wide.csv")




new.traitBP<-  merge(trait.wide, listSpp, by.x = "accepted_species", by.y = "spp", na.rm=TRUE)
view(new.traitBP)

write.csv(new.traitBP, "new.traitBP.csv")

